---
interface Props {
  title: string;
  slug: string;
  image?: string;
  category?: string;
}

const { title, slug, image, category } = Astro.props;
const baseUrl = import.meta.env.BASE_URL;
---

<div class="group relative flex flex-col overflow-hidden rounded-2xl bg-surface-light dark:bg-surface-dark shadow-sm ring-1 ring-black/5 dark:ring-white/10 transition-all duration-300 hover:-translate-y-1 hover:shadow-neon hover:ring-primary/50">
  <a href={`${baseUrl}/recipes/${slug}`} class="absolute inset-0 z-0" aria-label={`View recipe: ${title}`}></a>

  <div class="aspect-[4/3] w-full overflow-hidden bg-gray-100 dark:bg-gray-800 relative pointer-events-none">
    {image ? (
      <img
        src={image}
        alt={title}
        class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-110"
        loading="lazy"
      />
    ) : (
      <div class="flex h-full w-full items-center justify-center text-gray-300 dark:text-gray-600">
        <span class="material-symbols-outlined text-6xl">restaurant_menu</span>
      </div>
    )}
    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100"></div>

    <!-- Favorite Button -->
    <button
      class="fav-btn absolute right-3 top-3 z-20 flex size-10 items-center justify-center rounded-full bg-black/50 text-white backdrop-blur-md transition-all hover:bg-primary hover:text-black hover:scale-110 pointer-events-auto opacity-0 group-hover:opacity-100 focus:opacity-100"
      data-slug={slug}
      aria-label="Toggle favorite"
    >
      <span class="material-symbols-outlined text-[20px] font-variation-settings-fill">favorite</span>
    </button>
  </div>

  <div class="flex flex-1 flex-col p-5 pointer-events-none">
    {category && (
      <span class="mb-2 text-xs font-bold uppercase tracking-wider text-primary">
        {category}
      </span>
    )}
    <h3 class="font-display text-lg font-bold leading-tight text-text-light dark:text-text-dark group-hover:text-primary transition-colors">
      {title}
    </h3>

    <div class="mt-auto pt-4 flex items-center justify-between">
      <span class="text-xs font-medium text-gray-500 dark:text-gray-400 group-hover:text-text-light dark:group-hover:text-white transition-colors">
        View Recipe
      </span>
      <span class="material-symbols-outlined text-lg text-gray-400 transition-transform duration-300 group-hover:translate-x-1 group-hover:text-primary">
        arrow_forward
      </span>
    </div>
  </div>
</div>

<style>
  .font-variation-settings-fill {
    font-variation-settings: 'FILL' 0;
    transition: font-variation-settings 0.3s ease;
  }
  :global(.fav-btn.active) .font-variation-settings-fill {
    font-variation-settings: 'FILL' 1;
    color: #f9f506; /* Primary color */
  }
  :global(.fav-btn.active) {
    opacity: 1 !important;
    background-color: rgba(0,0,0,0.8);
  }
</style>
